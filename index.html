<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>Seismo-Wake ‚Äî Earthquake monitor</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="theme-color" content="#050608" />

  <!-- PWA manifest -->
  <link rel="manifest" href="manifest.webmanifest" />

  <style>
    :root {
      --bg: #050608;
      --bg-elevated: #0c0f15;
      --bg-elevated-soft: #101521;
      --border-subtle: rgba(255,255,255,0.06);
      --accent: #4fd1c5;
      --accent-soft: rgba(79,209,197,0.2);
      --danger: #ff4b4b;
      --warning: #ff9f3f;
      --info: #ffd447;
      --safe: #10b981;
      --text: #f9fafb;
      --text-muted: #9ca3af;
      --card-radius: 18px;
      --shadow-soft: 0 18px 40px rgba(0,0,0,0.55);
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    html {
      font-size: 16px;
    }

    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "SF Pro Text",
        "Segoe UI", sans-serif;
      background: radial-gradient(circle at top, #141a2b 0, #050608 45%, #000 100%);
      color: var(--text);
      min-height: 100vh;
      display: flex;
      justify-content: center;
      padding: 12px;
    }

    .app-shell {
      width: 100%;
      max-width: 860px;
      margin: auto;
      background: radial-gradient(circle at top left, #111827 0, #050608 55%);
      border-radius: 24px;
      border: 1px solid rgba(255,255,255,0.05);
      box-shadow: var(--shadow-soft);
      padding: 16px 14px 18px;
    }

    @media (min-width: 720px) {
      .app-shell {
        padding: 20px 24px 26px;
      }
    }

    .app-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      margin-bottom: 10px;
    }

    .title-wrap {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .app-title {
      font-size: 1.4rem;
      font-weight: 700;
      letter-spacing: 0.02em;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .pulse-dot {
      width: 12px;
      height: 12px;
      border-radius: 999px;
      background: radial-gradient(circle, #34d399 0, #065f46 55%, transparent 100%);
      position: relative;
      overflow: visible;
    }

    .pulse-dot::after {
      content: "";
      position: absolute;
      inset: -6px;
      border-radius: inherit;
      border: 1px solid rgba(52,211,153,0.4);
      opacity: 0;
      animation: pulse 2.2s infinite ease-out;
    }

    @keyframes pulse {
      0% { transform: scale(0.4); opacity: 0.9; }
      60% { transform: scale(1); opacity: 0; }
      100% { transform: scale(1); opacity: 0; }
    }

    .app-subtitle {
      font-size: 0.86rem;
      color: var(--text-muted);
      max-width: 460px;
    }

    .right-head {
      display: flex;
      flex-direction: column;
      align-items: flex-end;
      gap: 6px;
      font-size: 0.8rem;
    }

    .lang-switch {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      font-size: 0.8rem;
      color: var(--text-muted);
    }

    .lang-switch select {
      background: rgba(15,23,42,0.96);
      color: var(--text);
      border-radius: 999px;
      border: 1px solid rgba(156,163,175,0.6);
      padding: 4px 8px;
      font-size: 0.78rem;
      outline: none;
    }

    .updated-label {
      color: var(--text-muted);
      font-size: 0.8rem;
    }

    .updated-label span {
      color: var(--accent);
      font-weight: 500;
    }

    .status-card {
      margin-top: 10px;
      margin-bottom: 10px;
      border-radius: 20px;
      padding: 12px 13px;
      background: radial-gradient(circle at top left, rgba(34,197,94,0.12), rgba(15,23,42,0.96));
      border: 1px solid rgba(34,197,94,0.4);
    }

    @media (min-width: 720px) {
      .status-card {
        padding: 14px 16px;
      }
    }

    .status-title {
      font-size: 0.9rem;
      color: var(--text-muted);
      margin-bottom: 4px;
    }

    .status-main {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 4px;
    }

    .status-chip {
      border-radius: 999px;
      font-size: 0.86rem;
      padding: 4px 10px;
      font-weight: 600;
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .chip-dot {
      width: 8px;
      height: 8px;
      border-radius: 999px;
      background: var(--safe);
    }

    .status-text {
      font-size: 0.9rem;
    }

    .location-row {
      font-size: 0.82rem;
      color: var(--text-muted);
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
      align-items: center;
      margin-top: 2px;
    }

    .location-main {
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .location-main span {
      color: var(--text);
    }

    .location-main svg {
      width: 14px;
      height: 14px;
      opacity: 0.8;
    }

    .location-actions {
      display: flex;
      gap: 6px;
      flex-wrap: wrap;
    }

    .link-inline {
      color: var(--accent);
      font-size: 0.8rem;
      cursor: pointer;
      text-decoration: none;
      border-bottom: 1px dashed rgba(79,209,197,0.6);
    }

    .link-inline:hover {
      border-bottom-style: solid;
    }

    .tools-row {
      margin-top: 10px;
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }

    .tool-btn {
      flex: 1 1 130px;
      border-radius: 999px;
      border: 1px solid rgba(148,163,184,0.5);
      background: rgba(15,23,42,0.9);
      padding: 8px 10px;
      font-size: 0.84rem;
      color: var(--text);
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      cursor: pointer;
    }

    .tool-btn span.icon {
      font-size: 1rem;
    }

    .tool-btn:hover {
      background: rgba(30,64,175,0.75);
      border-color: rgba(129,140,248,0.8);
    }

    .section {
      margin-top: 12px;
      margin-bottom: 8px;
      background: rgba(15,23,42,0.96);
      border-radius: 18px;
      padding: 10px 10px 8px;
      border: 1px solid var(--border-subtle);
    }

    @media (min-width: 720px) {
      .section {
        padding: 12px 14px 10px;
      }
    }

    .section-header {
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      gap: 8px;
      margin-bottom: 6px;
    }

    .section-title {
      font-size: 0.96rem;
      font-weight: 600;
    }

    .section-note {
      font-size: 0.78rem;
      color: var(--text-muted);
    }

    .divider {
      margin: 8px 0;
      height: 1px;
      background: linear-gradient(to right, transparent, rgba(148,163,184,0.45), transparent);
    }

    .events-list {
      display: flex;
      flex-direction: column;
      gap: 6px;
      margin-top: 4px;
    }

    .event-card {
      border-radius: 14px;
      border: 1px solid rgba(31,41,55,0.85);
      background: rgba(15,23,42,0.9);
      padding: 8px 9px;
      font-size: 0.84rem;
    }

    .event-head-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 8px;
      margin-bottom: 2px;
    }

    .mag-badge {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      border-radius: 999px;
      padding: 2px 8px 3px;
      font-size: 0.82rem;
      background: rgba(15,23,42,0.85);
      border: 1px solid rgba(55,65,81,0.9);
    }

    .mag-badge strong {
      font-size: 0.88rem;
    }

    .mag-label {
      font-size: 0.8rem;
      color: var(--text-muted);
    }

    .event-time-ago {
      font-size: 0.8rem;
      color: var(--text-muted);
    }

    .event-subline {
      font-size: 0.8rem;
      color: var(--text-muted);
      margin-top: 1px;
    }

    .event-subline strong {
      color: var(--text);
    }

    .event-place {
      margin-top: 4px;
      font-size: 0.86rem;
    }

    .event-footer-row {
      margin-top: 4px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 8px;
      font-size: 0.78rem;
    }

    .event-depth {
      display: flex;
      flex-wrap: wrap;
      gap: 4px;
      align-items: baseline;
    }

    .depth {
      font-weight: 600;
    }

    .depth-note {
      font-size: 0.76rem;
      color: var(--text-muted);
    }

    .event-link {
      font-size: 0.78rem;
      color: var(--accent);
      text-decoration: none;
      border-bottom: 1px dashed rgba(79,209,197,0.5);
      white-space: nowrap;
    }

    .event-link:hover {
      border-bottom-style: solid;
    }

    .empty-state,
    .error-state {
      padding: 6px 8px;
      font-size: 0.82rem;
      border-radius: 10px;
      background: rgba(17,24,39,0.9);
      border: 1px dashed rgba(148,163,184,0.6);
      color: var(--text-muted);
    }

    .error-state {
      border-style: solid;
      border-color: rgba(248,113,113,0.7);
      color: #fecaca;
      background: radial-gradient(circle at top left, rgba(185,28,28,0.28), rgba(15,23,42,0.96));
    }

    .status-card-critical {
      background: radial-gradient(circle at top left, rgba(248,113,113,0.2), rgba(15,23,42,0.96));
      border-color: rgba(248,113,113,0.85);
    }

    .status-card-warning {
      background: radial-gradient(circle at top left, rgba(245,158,11,0.2), rgba(15,23,42,0.96));
      border-color: rgba(245,158,11,0.85);
    }

    .status-card-noticeable {
      background: radial-gradient(circle at top left, rgba(56,189,248,0.2), rgba(15,23,42,0.96));
      border-color: rgba(56,189,248,0.9);
    }

    .status-chip-safe .chip-dot {
      background: var(--safe);
    }

    .status-chip-noticeable .chip-dot {
      background: #38bdf8;
    }

    .status-chip-warning .chip-dot {
      background: var(--warning);
    }

    .status-chip-critical .chip-dot {
      background: var(--danger);
    }

    .status-chip-safe {
      background: rgba(16,185,129,0.12);
      border: 1px solid rgba(16,185,129,0.7);
      color: #bbf7d0;
    }

    .status-chip-noticeable {
      background: rgba(56,189,248,0.12);
      border: 1px solid rgba(56,189,248,0.6);
      color: #e0f2fe;
    }

    .status-chip-warning {
      background: rgba(245,158,11,0.12);
      border: 1px solid rgba(245,158,11,0.8);
      color: #fef3c7;
    }

    .status-chip-critical {
      background: rgba(248,113,113,0.14);
      border: 1px solid rgba(248,113,113,0.9);
      color: #fee2e2;
    }

    .depth-shallow {  /* 0-10 –∫–º */
      color: #ff4b4b;
    }
    .depth-low {      /* 10-30 –∫–º */
      color: #ff9f3f;
    }
    .depth-mid {      /* 30-70 –∫–º */
      color: #ffd447;
    }
    .depth-deep {     /* >70 –∫–º */
      color: #e5e7eb;
    }

    .world-section {
      background: radial-gradient(circle at top, rgba(30,64,175,0.55), #020617);
      border-radius: 18px;
      padding: 10px 10px 9px;
      border: 1px solid rgba(129,140,248,0.8);
      margin-top: 12px;
    }

    @media (min-width: 720px) {
      .world-section {
        padding: 12px 14px 10px;
      }
    }

    .world-section .section-header {
      margin-bottom: 6px;
    }

    .world-note {
      font-size: 0.78rem;
      color: var(--text-muted);
      margin-bottom: 4px;
    }

    /* modal */

    .modal-backdrop {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.68);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 50;
      padding: 10px;
    }

    .modal-backdrop.active {
      display: flex;
    }

    .modal {
      width: 100%;
      max-width: 520px;
      max-height: 90vh;
      background: radial-gradient(circle at top, #111827, #020617);
      border-radius: 20px;
      border: 1px solid rgba(148,163,184,0.6);
      padding: 14px 14px 12px;
      box-shadow: var(--shadow-soft);
      overflow: hidden;
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 8px;
      margin-bottom: 4px;
    }

    .modal-title {
      font-size: 1rem;
      font-weight: 600;
    }

    .modal-body {
      font-size: 0.9rem;
      color: var(--text-muted);
      overflow-y: auto;
      padding-right: 4px;
    }

    .modal-body p {
      margin-bottom: 6px;
    }

    .modal-body ul {
      padding-left: 1.1rem;
      margin-bottom: 6px;
    }

    .modal-body li {
      margin-bottom: 4px;
    }

    .modal-footer {
      margin-top: 6px;
      display: flex;
      justify-content: flex-end;
      gap: 6px;
    }

    .btn {
      border-radius: 999px;
      border: none;
      padding: 6px 11px;
      font-size: 0.84rem;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .btn-primary {
      background: linear-gradient(135deg, #4f46e5, #06b6d4);
      color: white;
    }

    .btn-secondary {
      background: rgba(15,23,42,0.95);
      color: var(--text);
      border: 1px solid rgba(148,163,184,0.6);
    }

    .btn-secondary:hover {
      background: rgba(30,64,175,0.8);
      border-color: rgba(129,140,248,0.85);
    }

    .btn-ghost {
      background: transparent;
      border: 1px solid rgba(55,65,81,0.8);
      color: var(--text-muted);
    }

    .btn-ghost:hover {
      background: rgba(31,41,55,0.9);
    }

    .donate-btn-link {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      border-radius: 999px;
      padding: 6px 11px;
      font-size: 0.84rem;
      text-decoration: none;
      margin-right: 6px;
      margin-bottom: 6px;
    }

    .donate-btn-link.boosty {
      background: rgba(249,115,22,0.12);
      border: 1px solid rgba(249,115,22,0.8);
      color: #fed7aa;
    }

    .donate-btn-link.kofi {
      background: rgba(56,189,248,0.12);
      border: 1px solid rgba(56,189,248,0.85);
      color: #e0f2fe;
    }

    .donate-small {
      font-size: 0.78rem;
      color: var(--text-muted);
      margin-top: 4px;
    }

    .close-icon-btn {
      border-radius: 999px;
      border: 1px solid rgba(75,85,99,0.9);
      background: rgba(15,23,42,0.95);
      color: var(--text-muted);
      width: 26px;
      height: 26px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      font-size: 0.82rem;
    }

    .world-event-card {
      border-radius: 12px;
      padding: 7px 8px;
      background: rgba(15,23,42,0.92);
      border: 1px solid rgba(129,140,248,0.7);
      font-size: 0.82rem;
    }

    .world-event-head {
      display: flex;
      justify-content: space-between;
      gap: 8px;
      margin-bottom: 2px;
    }

    .badge-strong {
      border-radius: 999px;
      padding: 2px 8px;
      font-size: 0.8rem;
      border: 1px solid rgba(129,140,248,0.9);
      background: rgba(30,64,175,0.5);
    }

    .badge-strong strong {
      font-size: 0.86rem;
    }

    .world-event-place {
      font-size: 0.84rem;
      margin-top: 2px;
    }

    .world-event-time {
      font-size: 0.78rem;
      color: var(--text-muted);
    }

    .world-event-footer {
      margin-top: 4px;
      display: flex;
      justify-content: space-between;
      gap: 6px;
      align-items: center;
      font-size: 0.78rem;
    }

    .badge-pill-muted {
      border-radius: 999px;
      border: 1px solid rgba(148,163,184,0.5);
      padding: 2px 7px;
      font-size: 0.76rem;
      color: var(--text-muted);
    }

    .donate-strip {
      margin-top: 10px;
      margin-bottom: 6px;
      border-radius: 16px;
      padding: 7px 9px;
      background: radial-gradient(circle at left, rgba(251,113,133,0.22), rgba(15,23,42,0.96));
      border: 1px solid rgba(248,113,113,0.85);
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 10px;
      font-size: 0.82rem;
    }

    .donate-strip strong {
      font-weight: 600;
    }

    .donate-strip button {
      white-space: nowrap;
    }

    .loc-input-row {
      margin-top: 6px;
      display: flex;
      gap: 6px;
      flex-wrap: wrap;
      align-items: center;
      font-size: 0.8rem;
    }

    .loc-input-row input {
      flex: 1 1 180px;
      border-radius: 999px;
      border: 1px solid rgba(148,163,184,0.6);
      background: rgba(15,23,42,0.95);
      padding: 5px 9px;
      font-size: 0.82rem;
      color: var(--text);
      outline: none;
    }

    .loc-input-row input::placeholder {
      color: rgba(148,163,184,0.8);
    }

    .loc-suggestions {
      margin-top: 4px;
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      font-size: 0.78rem;
    }

    .loc-chip {
      border-radius: 999px;
      border: 1px solid rgba(75,85,99,0.9);
      padding: 3px 8px;
      cursor: pointer;
      background: rgba(15,23,42,0.95);
    }

    .loc-chip:hover {
      background: rgba(31,41,55,0.95);
    }

    .foot-note {
      margin-top: 10px;
      font-size: 0.78rem;
      color: var(--text-muted);
      text-align: right;
    }

    .foot-note a {
      color: var(--accent);
      text-decoration: none;
      border-bottom: 1px dashed rgba(79,209,197,0.6);
    }

    .foot-note a:hover {
      border-bottom-style: solid;
    }
  </style>
</head>
<body>
  <div class="app-shell">
    <header class="app-header">
      <div class="title-wrap">
        <div class="app-title">
          <div class="pulse-dot"></div>
          <span>Seismo-Wake</span>
        </div>
        <div class="app-subtitle">
          –†–∞–Ω–Ω–µ–µ –∏–Ω—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –æ –∑–µ–º–ª–µ—Ç—Ä—è—Å–µ–Ω–∏—è—Ö –ø–æ–±–ª–∏–∑–æ—Å—Ç–∏ –∏ –æ–±–∑–æ—Ä —Å–∏–ª—å–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π –≤ –º–∏—Ä–µ.
        </div>
      </div>
      <div class="right-head">
        <div class="lang-switch">
          üåê –Ø–∑—ã–∫:
          <select id="langSelect">
            <option value="ru">RU</option>
            <option value="en">EN</option>
            <option value="kz">KZ</option>
            <option value="zh">‰∏≠Êñá</option>
            <option value="fr">FR</option>
          </select>
        </div>
        <div class="updated-label">
          –û–±–Ω–æ–≤–ª–µ–Ω–æ: <span id="updatedAt">‚Äî</span>
        </div>
      </div>
    </header>

    <section class="status-card" id="statusCard">
      <div class="status-title">–ü–æ—Å–ª–µ–¥–Ω–µ–µ –∑–Ω–∞—á–∏–º–æ–µ —Å–æ–±—ã—Ç–∏–µ –¥–ª—è –≤—ã–±—Ä–∞–Ω–Ω–æ–π —Ç–æ—á–∫–∏</div>
      <div class="status-main">
        <div class="status-chip status-chip-safe" id="statusChip">
          <div class="chip-dot"></div>
          <span id="statusChipText">–°–ø–æ–∫–æ–π–Ω–æ</span>
        </div>
        <div class="status-text" id="statusSummary">
          –í –≤–∞—à–µ–º —Ä–µ–≥–∏–æ–Ω–µ —Å–µ–π—á–∞—Å —Å–µ–π—Å–º–∏—á–µ—Å–∫–∞—è –æ–±—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–ø–æ–∫–æ–π–Ω–∞—è.
        </div>
      </div>
      <div class="location-row">
        <div class="location-main">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
            <path d="M12 22s7-7.188 7-12A7 7 0 0 0 5 10c0 4.812 7 12 7 12Z" stroke-width="1.6" />
            <circle cx="12" cy="10" r="3" stroke-width="1.6" />
          </svg>
          <span id="locationLabel">–ê–ª–º–∞—Ç—ã, –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω</span>
        </div>
      </div>
      <div class="loc-input-row">
        <input type="text" id="cityInput" placeholder="–ì–æ—Ä–æ–¥ –∏–ª–∏ —Ä–µ–≥–∏–æ–Ω (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ê–ª–º–∞—Ç—ã, Tokyo, Paris)" />
        <button class="btn btn-secondary" id="detectLocationBtn">–ê–≤—Ç–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ (GPS / IP)</button>
      </div>
      <div class="loc-suggestions" id="locSuggestions">
        <span class="loc-chip" data-city="–ê–ª–º–∞—Ç—ã, –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω" data-lat="43.238949" data-lon="76.889709">–ê–ª–º–∞—Ç—ã</span>
        <span class="loc-chip" data-city="–ê—Å—Ç–∞–Ω–∞, –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω" data-lat="51.169392" data-lon="71.449074">–ê—Å—Ç–∞–Ω–∞</span>
        <span class="loc-chip" data-city="–ë–∏—à–∫–µ–∫, –ö—ã—Ä–≥—ã–∑—Å—Ç–∞–Ω" data-lat="42.874722" data-lon="74.612222">–ë–∏—à–∫–µ–∫</span>
        <span class="loc-chip" data-city="–¢–æ–∫–∏–æ, –Ø–ø–æ–Ω–∏—è" data-lat="35.6762" data-lon="139.6503">Tokyo</span>
      </div>
    </section>

    <div class="donate-strip">
      <div>
        <strong>–í–∞—à –¥–æ–Ω–∞—Ç –º–æ–∂–µ—Ç —Å–ø–∞—Å—Ç–∏ –∂–∏–∑–Ω—å.</strong><br />
        –ü–æ–¥–¥–µ—Ä–∂–∏—Ç–µ —Ä–∞–∑–≤–∏—Ç–∏–µ Seismo-Wake, —á—Ç–æ–±—ã —Å–µ—Ä–≤–∏—Å –æ—Å—Ç–∞–≤–∞–ª—Å—è –±—ã—Å—Ç—Ä—ã–º –∏ –Ω–∞–¥—ë–∂–Ω—ã–º.
      </div>
      <button class="btn btn-primary" data-open-modal="donateModal">‚ù§Ô∏è –ü–æ–¥–¥–µ—Ä–∂–∞—Ç—å</button>
    </div>

    <div class="tools-row">
      <button class="tool-btn" data-open-modal="howModal">
        <span class="icon">‚ÑπÔ∏è</span><span>–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç</span>
      </button>
      <button class="tool-btn" data-open-modal="safetyModal">
        <span class="icon">üõ°Ô∏è</span><span>–ß—Ç–æ –¥–µ–ª–∞—Ç—å –ø—Ä–∏ –∑–µ–º–ª–µ—Ç—Ä—è—Å–µ–Ω–∏–∏</span>
      </button>
      <button class="tool-btn" id="installBtn" style="display:none;">
        <span class="icon">üì≤</span><span>–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ</span>
      </button>
      <button class="tool-btn" onclick="window.open('https://zhanat-arch.github.io/Seismo-Wake/', '_blank')">
        <span class="icon">üåê</span><span>–û—Ç–∫—Ä—ã—Ç—å –æ–Ω–ª–∞–π–Ω-–≤–µ—Ä—Å–∏—é</span>
      </button>
    </div>

    <section class="section" id="lastHourSection">
      <div class="section-header">
        <div class="section-title">–ü–æ—Å–ª–µ–¥–Ω–∏–µ –∑–Ω–∞—á–∏–º—ã–µ —Å–æ–±—ã—Ç–∏—è –∑–∞ —á–∞—Å (–ø–æ–±–ª–∏–∑–æ—Å—Ç–∏)</div>
        <div class="section-note" id="lastHourNote">–ù–µ –±–æ–ª–µ–µ 5 —Å–æ–±—ã—Ç–∏–π –≤ —Ä–∞–¥–∏—É—Å–µ ~2000 –∫–º</div>
      </div>
      <div class="events-list" id="lastHourList">
        <div class="empty-state">–î–∞–Ω–Ω—ã—Ö –ø–æ–∫–∞ –Ω–µ—Ç. –û–∂–∏–¥–∞–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è‚Ä¶</div>
      </div>
    </section>

    <section class="section" id="lastDaySection">
      <div class="section-header">
        <div class="section-title">–ó–Ω–∞—á–∏–º—ã–µ —Å–æ–±—ã—Ç–∏—è –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ —Å—É—Ç–∫–∏</div>
        <div class="section-note">–ü–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è —Å–æ–±—ã—Ç–∏—è, –Ω–µ –≤–æ—à–µ–¥—à–∏–µ –≤ –±–ª–æ–∫ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π —á–∞—Å</div>
      </div>
      <div class="events-list" id="lastDayList">
        <div class="empty-state">–ù–µ—Ç –∑–Ω–∞—á–∏–º—ã—Ö —Å–æ–±—ã—Ç–∏–π –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 24 —á–∞—Å–∞ –ø–æ–±–ª–∏–∑–æ—Å—Ç–∏.</div>
      </div>
    </section>

    <section class="section" id="lastWeekSection">
      <div class="section-header">
        <div class="section-title">–ó–Ω–∞—á–∏–º—ã–µ —Å–æ–±—ã—Ç–∏—è –∑–∞ –ø–æ—Å–ª–µ–¥–Ω—é—é –Ω–µ–¥–µ–ª—é</div>
        <div class="section-note">–ü–æ–±–ª–∏–∑–æ—Å—Ç–∏ –æ—Ç –≤—ã–±—Ä–∞–Ω–Ω–æ–π —Ç–æ—á–∫–∏</div>
      </div>
      <div class="events-list" id="lastWeekList">
        <div class="empty-state">–ó–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 7 –¥–Ω–µ–π –ø–æ–±–ª–∏–∑–æ—Å—Ç–∏ –∑–Ω–∞—á–∏–º—ã—Ö —Å–æ–±—ã—Ç–∏–π –Ω–µ –±—ã–ª–æ.</div>
      </div>
    </section>

    <section class="world-section" id="worldSection">
      <div class="section-header">
        <div class="section-title">üåç –°–∏–ª—å–Ω—ã–µ –∑–µ–º–ª–µ—Ç—Ä—è—Å–µ–Ω–∏—è –≤ –º–∏—Ä–µ (–∑–∞ —Å—É—Ç–∫–∏)</div>
      </div>
      <div class="world-note">
        –ó–¥–µ—Å—å –ø–æ–∫–∞–∑–∞–Ω—ã —Ç–æ–ª—å–∫–æ –∫—Ä—É–ø–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è (M5.0+) –ø–æ –≤—Å–µ–º—É –º–∏—Ä—É. –û–Ω–∏, –∫–∞–∫ –ø—Ä–∞–≤–∏–ª–æ, –Ω–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç —É–≥—Ä–æ–∑—ã –¥–ª—è –≤—ã–±—Ä–∞–Ω–Ω–æ–π —Ç–æ—á–∫–∏.
      </div>
      <div class="events-list" id="worldList">
        <div class="empty-state">–î–∞–Ω–Ω—ã—Ö –æ —Å–∏–ª—å–Ω—ã—Ö –º–∏—Ä–æ–≤—ã—Ö —Å–æ–±—ã—Ç–∏—è—Ö –ø–æ–∫–∞ –Ω–µ—Ç.</div>
      </div>
    </section>

    <div class="foot-note">
      –ü—Ä–æ–µ–∫—Ç –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ. –û–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏ –Ω–æ–≤–æ—Å—Ç–∏: <a href="https://github.com/zhanat-arch/Seismo-Wake" target="_blank">GitHub Seismo-Wake</a>
    </div>
  </div>

  <!-- MODALS -->

  <!-- How it works -->
  <div class="modal-backdrop" id="howModal">
    <div class="modal">
      <div class="modal-header">
        <div class="modal-title">–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç Seismo-Wake</div>
        <button class="close-icon-btn" data-close-modal>‚úï</button>
      </div>
      <div class="modal-body">
        <p><strong>–ö—Ä–∞—Ç–∫–æ:</strong> –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–µ–≥—É–ª—è—Ä–Ω–æ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç –æ—Ç–∫—Ä—ã—Ç—ã–µ —Å–µ–π—Å–º–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ (USGS) –∏ –æ—Ü–µ–Ω–∏–≤–∞–µ—Ç –∏—Ö –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –≤—ã–±—Ä–∞–Ω–Ω–æ–π —Ç–æ—á–∫–∏.</p>

        <p><strong>–ê–ª–≥–æ—Ä–∏—Ç–º:</strong></p>
        <ul>
          <li>–û–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –≤–∞—à–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ: –ø–æ –≥–æ—Ä–æ–¥—É, GPS –∏–ª–∏ IP.</li>
          <li>–ó–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –ø–æ—Å–ª–µ–¥–Ω–∏–µ –∑–µ–º–ª–µ—Ç—Ä—è—Å–µ–Ω–∏—è –∑–∞ 7 –¥–Ω–µ–π –ø–æ –≤—Å–µ–º—É –º–∏—Ä—É.</li>
          <li>–î–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–æ–±—ã—Ç–∏—è —Å—á–∏—Ç–∞–µ—Ç—Å—è —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–æ –≤–∞—à–µ–π —Ç–æ—á–∫–∏ –∏ –æ—Ü–µ–Ω–∏–≤–∞–µ—Ç—Å—è –º–∞–≥–Ω–∏—Ç—É–¥–∞, –≥–ª—É–±–∏–Ω–∞ –∏ –¥–∞–≤–Ω–æ—Å—Ç—å.</li>
          <li>–°–æ–±—ã—Ç–∏—è –¥–µ–ª—è—Ç—Å—è –Ω–∞ –±–ª–æ–∫–∏: –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π —á–∞—Å, —Å—É—Ç–∫–∏ –∏ –Ω–µ–¥–µ–ª—é –ø–æ–±–ª–∏–∑–æ—Å—Ç–∏.</li>
          <li>–û—Ç–¥–µ–ª—å–Ω–æ –≤—ã–¥–µ–ª—è–µ—Ç—Å—è ¬´–ü–æ—Å–ª–µ–¥–Ω–µ–µ –∑–Ω–∞—á–∏–º–æ–µ —Å–æ–±—ã—Ç–∏–µ –¥–ª—è –≤—ã–±—Ä–∞–Ω–Ω–æ–π —Ç–æ—á–∫–∏¬ª.</li>
          <li>–°–Ω–∏–∑—É –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è —Å–∏–ª—å–Ω—ã–µ –º–∏—Ä–æ–≤—ã–µ —Å–æ–±—ã—Ç–∏—è M5.0+ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ —Å—É—Ç–∫–∏.</li>
        </ul>

        <p><strong>–¶–≤–µ—Ç–∞ –≥–ª—É–±–∏–Ω—ã:</strong></p>
        <ul>
          <li><span class="depth depth-shallow">0‚Äì10 –∫–º</span> ‚Äî –æ—á–µ–Ω—å –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–Ω–æ–µ (–æ–±—ã—á–Ω–æ –æ—â—É—â–∞–µ—Ç—Å—è —Å–∏–ª—å–Ω–µ–µ –≤—Å–µ–≥–æ).</li>
          <li><span class="depth depth-low">10‚Äì30 –∫–º</span> ‚Äî –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–Ω–æ–µ.</li>
          <li><span class="depth depth-mid">30‚Äì70 –∫–º</span> ‚Äî —Å—Ä–µ–¥–Ω—è—è –≥–ª—É–±–∏–Ω–∞.</li>
          <li><span class="depth depth-deep">>70 –∫–º</span> ‚Äî –≥–ª—É–±–æ–∫–æ–µ, –∫–∞–∫ –ø—Ä–∞–≤–∏–ª–æ, –æ—â—É—â–∞–µ—Ç—Å—è —Å–ª–∞–±–µ–µ.</li>
        </ul>

        <p><strong>–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö:</strong></p>
        <ul>
          <li>–ü—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–æ–º —ç–∫—Ä–∞–Ω–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç —Å–≤–µ–∂–∏–µ –¥–∞–Ω–Ω—ã–µ (–∫–∞–∂–¥—ã–µ ~30 —Å–µ–∫—É–Ω–¥).</li>
          <li>–ï—Å–ª–∏ —Å–≤—è–∑—å –ø—Ä–æ–ø–∞–ª–∞, –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ–¥–Ω–µ–µ —É–¥–∞—á–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ.</li>
        </ul>

        <p><strong>–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–∞–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏ –∞–≤—Ç–æ-–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:</strong></p>
        <ul>
          <li>–û—Ç–∫—Ä–æ–π—Ç–µ –æ–Ω–ª–∞–π–Ω-–≤–µ—Ä—Å–∏—é: <a href="https://zhanat-arch.github.io/Seismo-Wake/" target="_blank">https://zhanat-arch.github.io/Seismo-Wake/</a></li>
          <li>–í –±—Ä–∞—É–∑–µ—Ä–µ (Chrome/Android) –≤—ã–±–µ—Ä–∏—Ç–µ ¬´–î–æ–±–∞–≤–∏—Ç—å –Ω–∞ –≥–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω¬ª –∏–ª–∏ ¬´–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ¬ª.</li>
          <li>–ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ Seismo-Wake –±—É–¥–µ—Ç –æ—Ç–∫—Ä—ã–≤–∞—Ç—å—Å—è –æ–¥–Ω–∏–º –Ω–∞–∂–∞—Ç–∏–µ–º –∏ –ø–æ–ª—É—á–∞—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ —Å–µ—Ç–∏.</li>
        </ul>

        <p><strong>–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:</strong></p>
        <ul>
          <li>–í —Ç–µ–∫—É—â–µ–π –≤–µ—Ä—Å–∏–∏ –Ω–µ—Ç —Ñ–æ–Ω–æ–≤—ã—Ö push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π ‚Äî —á—Ç–æ–±—ã –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–∏—Ç—É–∞—Ü–∏—é, –æ—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏–ª–∏ –æ–Ω–ª–∞–π–Ω-—Å—Ç—Ä–∞–Ω–∏—Ü—É.</li>
          <li>–°–µ—Ä–≤–∏—Å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –æ—Ç–∫—Ä—ã—Ç—ã–µ –ø—É–±–ª–∏—á–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –∏ –Ω–µ –∑–∞–º–µ–Ω—è–µ—Ç –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ú–ß–°.</li>
        </ul>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" data-close-modal>–ü–æ–Ω—è—Ç–Ω–æ</button>
      </div>
    </div>
  </div>

  <!-- Safety -->
  <div class="modal-backdrop" id="safetyModal">
    <div class="modal">
      <div class="modal-header">
        <div class="modal-title">–ß—Ç–æ –¥–µ–ª–∞—Ç—å –ø—Ä–∏ –∑–µ–º–ª–µ—Ç—Ä—è—Å–µ–Ω–∏–∏</div>
        <button class="close-icon-btn" data-close-modal>‚úï</button>
      </div>
      <div class="modal-body">
        <p><strong>–í–∞–∂–Ω–æ:</strong> —Å–æ—Ö—Ä–∞–Ω—è–π—Ç–µ —Å–ø–æ–∫–æ–π—Å—Ç–≤–∏–µ –∏ –¥–µ–π—Å—Ç–≤—É–π—Ç–µ –ø–æ –ø—Ä–æ—Å—Ç–æ–π —Å—Ö–µ–º–µ. –ù–∏–∂–µ ‚Äî –æ–±—â–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏, –Ω–µ –∑–∞–º–µ–Ω—è—é—â–∏–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –º–µ—Å—Ç–Ω—ã—Ö —Å–ª—É–∂–±.</p>

        <p><strong>–ï—Å–ª–∏ –≤—ã –¥–æ–º–∞ / –≤ –∫–≤–∞—Ä—Ç–∏—Ä–µ:</strong></p>
        <ul>
          <li>–û—Ç–æ–π–¥–∏—Ç–µ –æ—Ç –æ–∫–æ–Ω, —Å—Ç–µ–∫–ª–∞, —Ç—è–∂—ë–ª—ã—Ö —à–∫–∞—Ñ–æ–≤ –∏ –Ω–∞–≤–µ—Å–Ω—ã—Ö –ø–æ–ª–æ–∫.</li>
          <li>–í—Å—Ç–∞–Ω—å—Ç–µ —É –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π –Ω–µ—Å—É—â–µ–π —Å—Ç–µ–Ω—ã, –≤ –ø—Ä–æ—Å—Ç–µ–Ω–∫–µ –∏–ª–∏ –ø–æ–¥ –ø—Ä–æ—á–Ω–æ–π —Å—Ç–æ–ª–µ—à–Ω–∏—Ü–µ–π.</li>
          <li>–ù–µ –±–µ–≥–∏—Ç–µ –∫ –ª–∏—Ñ—Ç—É –∏ –Ω–µ –ø–æ–ª—å–∑—É–π—Ç–µ—Å—å –∏–º.</li>
          <li>–ï—Å–ª–∏ –∑–Ω–∞–µ—Ç–µ, –≥–¥–µ –ø—Ä–æ—Ö–æ–¥—è—Ç —Ä–∏–≥–µ–ª–∏ –∏ –Ω–µ—Å—É—â–∏–µ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏, –≤—Å—Ç–∞–Ω—å—Ç–µ –ø–æ–¥ –Ω–∏–º–∏ –∏–ª–∏ —Ä—è–¥–æ–º.</li>
        </ul>

        <p><strong>–ï—Å–ª–∏ –≤—ã –≤ –≤—ã—Å–æ—Ç–Ω–æ–º –∑–¥–∞–Ω–∏–∏:</strong></p>
        <ul>
          <li>–ù–µ –ø—ã—Ç–∞–π—Ç–µ—Å—å —Å—Ä–∞–∑—É –≤—ã–±–µ–∂–∞—Ç—å –ø–æ –ª–µ—Å—Ç–Ω–∏—Ü–µ, –ø–æ–∫–∞ —Ç–æ–ª—á–∫–∏ —Å–∏–ª—å–Ω—ã–µ ‚Äî —ç—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ–ø–∞—Å–Ω–æ.</li>
          <li>–ó–∞—â–∏—Ç–∏—Ç–µ –≥–æ–ª–æ–≤—É (–æ–¥–µ–∂–¥–æ–π, –ø–æ–¥—É—à–∫–æ–π, —Å—É–º–∫–æ–π) –∏ –¥–æ–∂–¥–∏—Ç–µ—Å—å –æ—Å–ª–∞–±–ª–µ–Ω–∏—è —Ç–æ–ª—á–∫–æ–≤.</li>
          <li>–ü–æ—Å–ª–µ –æ—Å–ª–∞–±–ª–µ–Ω–∏—è —Å–ø–æ–∫–æ–π–Ω–æ —Å–ø—É—Å–∫–∞–π—Ç–µ—Å—å –ø–æ –ª–µ—Å—Ç–Ω–∏—Ü–µ, –∏–∑–±–µ–≥–∞—è –ª–∏—Ñ—Ç–æ–≤.</li>
        </ul>

        <p><strong>–ï—Å–ª–∏ –≤—ã –Ω–∞ —É–ª–∏—Ü–µ:</strong></p>
        <ul>
          <li>–û—Ç–æ–π–¥–∏—Ç–µ –æ—Ç —Ñ–∞—Å–∞–¥–æ–≤ –∑–¥–∞–Ω–∏–π, –≤–∏—Ç—Ä–∏–Ω, –ª–∏–Ω–∏–π —ç–ª–µ–∫—Ç—Ä–æ–ø–µ—Ä–µ–¥–∞—á–∏, –¥–µ—Ä–µ–≤—å–µ–≤ –∏ —Ä–µ–∫–ª–∞–º–Ω—ã—Ö —â–∏—Ç–æ–≤.</li>
          <li>–ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –±–æ–ª–µ–µ –æ—Ç–∫—Ä—ã—Ç–æ–µ –º–µ—Å—Ç–æ (–ø–ª–æ—â–∞–¥—å, –ø–∞—Ä–∫–æ–≤–∫–∞) –∏ –æ—Å—Ç–∞–≤–∞–π—Ç–µ—Å—å —Ç–∞–º –¥–æ –æ–∫–æ–Ω—á–∞–Ω–∏—è —Ç–æ–ª—á–∫–æ–≤.</li>
        </ul>

        <p><strong>–ï—Å–ª–∏ –≤—ã –≤ –∞–≤—Ç–æ–º–æ–±–∏–ª–µ:</strong></p>
        <ul>
          <li>–û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ—Å—å –ø–æ–¥–∞–ª—å—à–µ –æ—Ç –º–æ—Å—Ç–æ–≤, —Ä–∞–∑–≤—è–∑–æ–∫, —Ç—É–Ω–Ω–µ–ª–µ–π –∏ –∑–¥–∞–Ω–∏–π.</li>
          <li>–û—Å—Ç–∞–≤–∞–π—Ç–µ—Å—å –≤ –º–∞—à–∏–Ω–µ, –ø–æ–∫–∞ –æ—Å–Ω–æ–≤–Ω—ã–µ —Ç–æ–ª—á–∫–∏ –Ω–µ –∑–∞–∫–æ–Ω—á–∞—Ç—Å—è.</li>
          <li>–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ –ø—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ –¥–≤–∏–∂–µ–Ω–∏–µ, –æ–±—Ä–∞—â–∞—è –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –¥–æ—Ä–æ–≥–∏.</li>
        </ul>

        <p><strong>–ü–æ—Å–ª–µ –∑–µ–º–ª–µ—Ç—Ä—è—Å–µ–Ω–∏—è:</strong></p>
        <ul>
          <li>–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–µ–±—è –∏ –±–ª–∏–∑–∫–∏—Ö –Ω–∞ –Ω–∞–ª–∏—á–∏–µ —Ç—Ä–∞–≤–º, –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –≤—ã–∑–æ–≤–∏—Ç–µ —Å–∫–æ—Ä—É—é.</li>
          <li>–ù–µ –ø–æ–ª—å–∑—É–π—Ç–µ—Å—å –æ—Ç–∫—Ä—ã—Ç—ã–º –æ–≥–Ω—ë–º, –µ—Å–ª–∏ –µ—Å—Ç—å –∑–∞–ø–∞—Ö –≥–∞–∑–∞, –∏ –ø–µ—Ä–µ–∫—Ä–æ–π—Ç–µ –≥–∞–∑, –µ—Å–ª–∏ –º–æ–∂–µ—Ç–µ.</li>
          <li>–ë—É–¥—å—Ç–µ –≥–æ—Ç–æ–≤—ã –∫ –ø–æ–≤—Ç–æ—Ä–Ω—ã–º —Ç–æ–ª—á–∫–∞–º (–∞—Ñ—Ç–µ—Ä—à–æ–∫–∏).</li>
          <li>–ù–µ –∑–∞—Ö–æ–¥–∏—Ç–µ –≤ —Å–µ—Ä—å—ë–∑–Ω–æ –ø–æ–≤—Ä–µ–∂–¥—ë–Ω–Ω—ã–µ –∑–¥–∞–Ω–∏—è –±–µ–∑ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–≤.</li>
          <li>–°–ª–µ–¥–∏—Ç–µ –∑–∞ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–º–∏ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏ –º–µ—Å—Ç–Ω—ã—Ö —Å–ª—É–∂–±.</li>
        </ul>

        <p>Seismo-Wake ‚Äî –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç, –∞ –Ω–µ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –æ–ø–æ–≤–µ—â–µ–Ω–∏—è. –í–∞—à–µ —Å–ø–æ–∫–æ–π—Å—Ç–≤–∏–µ –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω–æ—Å—Ç—å ‚Äî –ª—É—á—à–∏–π —Å–ø–æ—Å–æ–± —Å–Ω–∏–∑–∏—Ç—å —Ä–∏—Å–∫.</p>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" data-close-modal>–ó–∞–∫—Ä—ã—Ç—å</button>
      </div>
    </div>
  </div>

  <!-- Donate -->
  <div class="modal-backdrop" id="donateModal">
    <div class="modal">
      <div class="modal-header">
        <div class="modal-title">‚ù§Ô∏è –ü–æ–¥–¥–µ—Ä–∂–∞—Ç—å —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞</div>
        <button class="close-icon-btn" data-close-modal>‚úï</button>
      </div>
      <div class="modal-body">
        <p>–°–ø–∞—Å–∏–±–æ, —á—Ç–æ –ø–æ–ª—å–∑—É–µ—Ç–µ—Å—å <strong>Seismo-Wake</strong>. –í–∞—à –¥–æ–Ω–∞—Ç –ø–æ–º–æ–≥–∞–µ—Ç —Ä–∞–∑–≤–∏–≤–∞—Ç—å —Å–µ—Ä–≤–∏—Å, —É—Å–∫–æ—Ä—è—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏ –¥–µ–ª–∞—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞–¥—ë–∂–Ω–µ–µ ‚Äî —ç—Ç–æ –º–æ–∂–µ—Ç —Å–ø–∞—Å—Ç–∏ —á—å—é-—Ç–æ –∂–∏–∑–Ω—å.</p>

        <p><strong>üí≥ –î–æ–Ω–∞—Ç –±–∞–Ω–∫–æ–≤—Å–∫–æ–π –∫–∞—Ä—Ç–æ–π (–ª—é–±–∞—è —Å—Ç—Ä–∞–Ω–∞)</strong></p>
        <p>Boosty –ø—Ä–∏–Ω–∏–º–∞–µ—Ç Visa / MasterCard –∏ –¥—Ä—É–≥–∏–µ –∫–∞—Ä—Ç—ã. –ü–æ–¥—Ö–æ–¥–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –∏–∑ –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω–∞, –†–æ—Å—Å–∏–∏, –ï–≤—Ä–æ–ø—ã, –¢—É—Ä—Ü–∏–∏, –°–®–ê –∏ –º–Ω–æ–≥–∏—Ö –¥—Ä—É–≥–∏—Ö —Å—Ç—Ä–∞–Ω.</p>
        <a class="donate-btn-link boosty" href="https://boosty.to/zhanat-arch" target="_blank">–ü–æ–¥–¥–µ—Ä–∂–∞—Ç—å —á–µ—Ä–µ–∑ Boosty</a>

        <p style="margin-top:8px;"><strong>üåç –î–æ–Ω–∞—Ç —á–µ—Ä–µ–∑ PayPal</strong></p>
        <p>–î–ª—è –º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ–º—É —É–¥–æ–±–Ω–µ–µ PayPal.</p>
        <a class="donate-btn-link kofi" href="https://ko-fi.com/zhanat_arch" target="_blank">–ü–æ–¥–¥–µ—Ä–∂–∞—Ç—å —á–µ—Ä–µ–∑ Ko-fi (PayPal)</a>

        <p class="donate-small">–ö–∞–∂–¥—ã–π –≤–∫–ª–∞–¥ –ø–æ–º–æ–≥–∞–µ—Ç —Å–¥–µ–ª–∞—Ç—å Seismo-Wake –ª—É—á—à–µ. –°–ø–∞—Å–∏–±–æ –∑–∞ –ø–æ–¥–¥–µ—Ä–∂–∫—É!</p>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" data-close-modal>–ó–∞–∫—Ä—ã—Ç—å</button>
      </div>
    </div>
  </div>

  <script>
    (function () {
      const USGS_URL =
        "https://earthquake.usgs.gov/earthquakes/feed/v1.0/summary/all_week.geojson";
      const MAX_DISTANCE_KM = 2000; // —Ä–∞–¥–∏—É—Å "–ø–æ–±–ª–∏–∑–æ—Å—Ç–∏"
      const SIGNIFICANT_MAG = 2.5;
      const ONE_HOUR = 60 * 60 * 1000;
      const ONE_DAY = 24 * ONE_HOUR;
      const ONE_WEEK = 7 * ONE_DAY;

      const DEFAULT_LOCATION = {
        lat: 43.238949,
        lon: 76.889709,
        label: "–ê–ª–º–∞—Ç—ã, –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω",
      };

      let userLocation = { ...DEFAULT_LOCATION };
      let lastEventsRaw = [];
      let lastFetchTime = null;
      let lastDataOk = false;
      let deferredInstallPrompt = null;

      const updatedAtEl = document.getElementById("updatedAt");
      const statusCard = document.getElementById("statusCard");
      const statusChip = document.getElementById("statusChip");
      const statusChipText = document.getElementById("statusChipText");
      const statusSummary = document.getElementById("statusSummary");
      const locationLabel = document.getElementById("locationLabel");

      const lastHourList = document.getElementById("lastHourList");
      const lastDayList = document.getElementById("lastDayList");
      const lastWeekList = document.getElementById("lastWeekList");
      const worldList = document.getElementById("worldList");

      const detectLocationBtn = document.getElementById("detectLocationBtn");
      const cityInput = document.getElementById("cityInput");
      const locSuggestions = document.getElementById("locSuggestions");
      const installBtn = document.getElementById("installBtn");

      /* -------- Utils ---------- */

      function haversineKm(lat1, lon1, lat2, lon2) {
        const R = 6371;
        const toRad = (d) => (d * Math.PI) / 180;
        const dLat = toRad(lat2 - lat1);
        const dLon = toRad(lon2 - lon1);
        const a =
          Math.sin(dLat / 2) * Math.sin(dLat / 2) +
          Math.cos(toRad(lat1)) *
            Math.cos(toRad(lat2)) *
            Math.sin(dLon / 2) *
            Math.sin(dLon / 2);
        const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
        return R * c;
      }

      function formatDateTime(ts) {
        const d = new Date(ts);
        const day = String(d.getDate()).padStart(2, "0");
        const monthNames = ["—è–Ω–≤", "—Ñ–µ–≤", "–º–∞—Ä", "–∞–ø—Ä", "–º–∞—è", "–∏—é–Ω", "–∏—é–ª", "–∞–≤–≥", "—Å–µ–Ω", "–æ–∫—Ç", "–Ω–æ—è", "–¥–µ–∫"];
        const month = monthNames[d.getMonth()];
        const hours = String(d.getHours()).padStart(2, "0");
        const mins = String(d.getMinutes()).padStart(2, "0");
        return `${hours}:${mins} ¬∑ ${day} ${month}`;
      }

      function formatUpdated(ts) {
        if (!ts) return "‚Äî";
        const d = new Date(ts);
        const day = String(d.getDate()).padStart(2, "0");
        const month = String(d.getMonth() + 1).padStart(2, "0");
        const year = d.getFullYear();
        const h = String(d.getHours()).padStart(2, "0");
        const m = String(d.getMinutes()).padStart(2, "0");
        const s = String(d.getSeconds()).padStart(2, "0");
        return `${day}.${month}.${year} ${h}:${m}:${s}`;
      }

      function formatAgo(ts) {
        const now = Date.now();
        const diff = now - ts;
        if (diff < 60 * 1000) return "—Ç–æ–ª—å–∫–æ —á—Ç–æ";
        if (diff < 60 * 60 * 1000) {
          const m = Math.round(diff / (60 * 1000));
          return `${m} –º–∏–Ω –Ω–∞–∑–∞–¥`;
        }
        if (diff < 24 * 60 * 60 * 1000) {
          const h = Math.round(diff / (60 * 60 * 1000));
          return `${h} —á –Ω–∞–∑–∞–¥`;
        }
        const d = Math.round(diff / (24 * 60 * 60 * 1000));
        return `${d} –¥–Ω –Ω–∞–∑–∞–¥`;
      }

      function depthClass(d) {
        if (!isFinite(d)) return "depth-deep";
        if (d <= 10) return "depth-shallow";
        if (d <= 30) return "depth-low";
        if (d <= 70) return "depth-mid";
        return "depth-deep";
      }

      function depthLabel(d) {
        if (!isFinite(d)) return "–≥–ª—É–±–∏–Ω–∞ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–∞";
        if (d <= 10) return "–æ—á–µ–Ω—å –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–Ω–æ–µ";
        if (d <= 30) return "–ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–Ω–æ–µ";
        if (d <= 70) return "—Å—Ä–µ–¥–Ω—è—è –≥–ª—É–±–∏–Ω–∞";
        return "–≥–ª—É–±–æ–∫–æ–µ";
      }

      function riskLevel(ev) {
        const m = ev.mag || 0;
        const d = ev.distanceKm;
        const depth = ev.depthKm;

        if (!isFinite(d)) return "info";

        if (d <= 100) {
          if (m >= 6) return "critical";
          if (m >= 5 && depth <= 30) return "warning";
          if (m >= 4) return "noticeable";
          return "safe";
        } else if (d <= 300) {
          if (m >= 7) return "critical";
          if (m >= 5) return "warning";
          if (m >= 4) return "noticeable";
          return "safe";
        } else if (d <= MAX_DISTANCE_KM) {
          if (m >= 7) return "warning";
          if (m >= 5) return "noticeable";
          return "safe";
        }

        return "info";
      }

      function setLocationInfo() {
        locationLabel.textContent = userLocation.label;
      }

      function setUpdatedTime(ts) {
        updatedAtEl.textContent = formatUpdated(ts);
      }

      /* -------- Fetch & process ---------- */

      async function fetchEvents() {
        const res = await fetch(USGS_URL);
        if (!res.ok) throw new Error("USGS error " + res.status);
        const data = await res.json();
        const features = data.features || [];
        const events = features
          .map((f) => {
            const props = f.properties || {};
            const coords = (f.geometry && f.geometry.coordinates) || [];
            const lon = coords[0];
            const lat = coords[1];
            const depth = coords[2];
            const t = props.time;
            return {
              id: f.id,
              mag: typeof props.mag === "number" ? props.mag : null,
              place: props.place || "",
              time: typeof t === "number" ? t : null,
              url: props.url || "",
              lat: typeof lat === "number" ? lat : null,
              lon: typeof lon === "number" ? lon : null,
              depthKm: typeof depth === "number" ? depth : null,
            };
          })
          .filter((e) => e.time);
        return events;
      }

      function enrichWithDistance(list) {
        return list.map((e) => {
          if (
            typeof e.lat === "number" &&
            typeof e.lon === "number" &&
            isFinite(e.lat) &&
            isFinite(e.lon)
          ) {
            e.distanceKm = haversineKm(userLocation.lat, userLocation.lon, e.lat, e.lon);
          } else {
            e.distanceKm = Infinity;
          }
          return e;
        });
      }

      function isSignificant(ev) {
        const m = ev.mag || 0;
        const d = ev.distanceKm;
        if (!isFinite(d)) return m >= 4;
        if (d <= 300) {
          return m >= 2.5;
        }
        return m >= 4;
      }

      function partitionLocal(events) {
        const now = Date.now();
        const nearest = events.filter(
          (e) =>
            isFinite(e.distanceKm) &&
            e.distanceKm <= MAX_DISTANCE_KM &&
            now - e.time <= ONE_WEEK &&
            isSignificant(e)
        );

        const lastHour = [];
        const lastDay = [];
        const lastWeek = [];

        for (const ev of nearest) {
          const age = now - ev.time;
          if (age <= ONE_HOUR) {
            lastHour.push(ev);
          } else if (age <= ONE_DAY) {
            lastDay.push(ev);
          } else if (age <= ONE_WEEK) {
            lastWeek.push(ev);
          }
        }

        const sortDesc = (a, b) => b.time - a.time;

        lastHour.sort(sortDesc);
        lastDay.sort(sortDesc);
        lastWeek.sort(sortDesc);

        const lHour = lastHour.slice(0, 5);
        const usedIds = new Set(lHour.map((e) => e.id));

        const dayFiltered = lastDay.filter((e) => !usedIds.has(e.id));
        dayFiltered.sort(sortDesc);
        const lDay = dayFiltered.slice(0, 5);
        lDay.forEach((e) => usedIds.add(e.id));

        const weekFiltered = lastWeek.filter((e) => !usedIds.has(e.id));
        weekFiltered.sort(sortDesc);
        const lWeek = weekFiltered.slice(0, 5);

        return { lastHour: lHour, lastDay: lDay, lastWeek: lWeek };
      }

      function pickLastSignificant(buckets) {
        if (buckets.lastHour.length) return buckets.lastHour[0];
        if (buckets.lastDay.length) return buckets.lastDay[0];
        if (buckets.lastWeek.length) return buckets.lastWeek[0];
        return null;
      }

      function pickWorldStrong(events) {
        const now = Date.now();
        const strong = events.filter(
          (e) =>
            e.mag != null &&
            e.mag >= 5 &&
            now - e.time <= ONE_DAY
        );
        strong.sort((a, b) => b.time - a.time);
        return strong.slice(0, 5);
      }

      /* -------- Rendering ---------- */

      function clearNode(node) {
        while (node.firstChild) node.removeChild(node.firstChild);
      }

      function renderLocalBuckets(buckets) {
        // last hour
        clearNode(lastHourList);
        if (!buckets.lastHour.length) {
          const div = document.createElement("div");
          div.className = "empty-state";
          div.textContent = "–ó–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π —á–∞—Å –ø–æ–±–ª–∏–∑–æ—Å—Ç–∏ –∑–Ω–∞—á–∏–º—ã—Ö —Ç–æ–ª—á–∫–æ–≤ –Ω–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–æ.";
          lastHourList.appendChild(div);
        } else {
          buckets.lastHour.forEach((ev) => {
            lastHourList.appendChild(renderEventCard(ev));
          });
        }

        // day
        clearNode(lastDayList);
        if (!buckets.lastDay.length) {
          const div = document.createElement("div");
          div.className = "empty-state";
          div.textContent = "–ó–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ —Å—É—Ç–∫–∏ –ø–æ–±–ª–∏–∑–æ—Å—Ç–∏ –Ω–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–Ω–∞—á–∏–º—ã—Ö —Å–æ–±—ã—Ç–∏–π.";
          lastDayList.appendChild(div);
        } else {
          buckets.lastDay.forEach((ev) => {
            lastDayList.appendChild(renderEventCard(ev));
          });
        }

        // week
        clearNode(lastWeekList);
        if (!buckets.lastWeek.length) {
          const div = document.createElement("div");
          div.className = "empty-state";
          div.textContent = "–ó–∞ –ø–æ—Å–ª–µ–¥–Ω—é—é –Ω–µ–¥–µ–ª—é –ø–æ–±–ª–∏–∑–æ—Å—Ç–∏ –Ω–æ–≤—ã—Ö –∑–Ω–∞—á–∏–º—ã—Ö —Å–æ–±—ã—Ç–∏–π –Ω–µ –±—ã–ª–æ.";
          lastWeekList.appendChild(div);
        } else {
          buckets.lastWeek.forEach((ev) => {
            lastWeekList.appendChild(renderEventCard(ev));
          });
        }
      }

      function renderEventCard(ev) {
        const card = document.createElement("div");
        card.className = "event-card";

        const head = document.createElement("div");
        head.className = "event-head-row";

        const magBadge = document.createElement("div");
        magBadge.className = "mag-badge";
        const magVal = document.createElement("strong");
        magVal.textContent = ev.mag != null ? `M${ev.mag.toFixed(1)}` : "M?";
        const magLabel = document.createElement("span");
        magLabel.className = "mag-label";
        magLabel.textContent = formatAgo(ev.time);
        magBadge.appendChild(magVal);
        magBadge.appendChild(magLabel);

        const timeExact = document.createElement("div");
        timeExact.className = "event-time-ago";
        timeExact.textContent = formatDateTime(ev.time);

        head.appendChild(magBadge);
        head.appendChild(timeExact);

        const sub1 = document.createElement("div");
        sub1.className = "event-subline";

        const depthText = document.createElement("span");
        const d = ev.depthKm;
        const dCls = depthClass(d);
        const dLbl = depthLabel(d);
        depthText.innerHTML =
          `–ì–ª—É–±–∏–Ω–∞: <span class="depth ${dCls}">${isFinite(d) ? d.toFixed(0) + " –∫–º" : "‚Äî"}</span> ` +
          `<span class="depth-note">‚Äî ${dLbl}</span>`;

        const distSpan = document.createElement("span");
        if (isFinite(ev.distanceKm)) {
          distSpan.innerHTML =
            ' ¬∑ –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ: <strong>' + ev.distanceKm.toFixed(0) + ' –∫–º</strong>';
        } else {
          distSpan.innerHTML = ' ¬∑ –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ: <strong>‚Äî</strong>';
        }

        sub1.appendChild(depthText);
        sub1.appendChild(distSpan);

        const place = document.createElement("div");
        place.className = "event-place";
        place.textContent = ev.place || "–†–µ–≥–∏–æ–Ω –Ω–µ —É–∫–∞–∑–∞–Ω";

        const footer = document.createElement("div");
        footer.className = "event-footer-row";

        const risk = riskLevel(ev);
        const riskSpan = document.createElement("span");
        riskSpan.className = "badge-pill-muted";
        if (risk === "critical") {
          riskSpan.textContent = "–û—á–µ–Ω—å —Å–∏–ª—å–Ω–æ–µ —Ä—è–¥–æ–º";
        } else if (risk === "warning") {
          riskSpan.textContent = "–°–∏–ª—å–Ω–æ–µ / –ª—É—á—à–µ –æ—Ç–æ–π—Ç–∏ –æ—Ç —Å—Ç–µ–∫–æ–ª";
        } else if (risk === "noticeable") {
          riskSpan.textContent = "–ú–æ–∂–µ—Ç –æ—â—É—Ç–∏–º–æ —á—É–≤—Å—Ç–≤–æ–≤–∞—Ç—å—Å—è";
        } else if (risk === "safe") {
          riskSpan.textContent = "–í–µ—Ä–æ—è—Ç–Ω–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ –¥–ª—è —ç—Ç–æ–π —Ç–æ—á–∫–∏";
        } else {
          riskSpan.textContent = "–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø–æ —Å–æ–±—ã—Ç–∏—é";
        }

        const link = document.createElement("a");
        link.className = "event-link";
        link.href = ev.url || "#";
        link.target = "_blank";
        link.textContent = "–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –Ω–∞ —Å–∞–π—Ç–µ";

        footer.appendChild(riskSpan);
        footer.appendChild(link);

        card.appendChild(head);
        card.appendChild(sub1);
        card.appendChild(place);
        card.appendChild(footer);
        return card;
      }

      function renderWorld(strongEvents) {
        clearNode(worldList);
        if (!strongEvents.length) {
          const div = document.createElement("div");
          div.className = "empty-state";
          div.textContent = "–°–∏–ª—å–Ω—ã—Ö –∑–µ–º–ª–µ—Ç—Ä—è—Å–µ–Ω–∏–π (M5.0+) –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ —Å—É—Ç–∫–∏ –Ω–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–æ –∏–ª–∏ –¥–∞–Ω–Ω—ã–µ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã.";
          worldList.appendChild(div);
          return;
        }

        strongEvents.forEach((ev) => {
          const card = document.createElement("div");
          card.className = "world-event-card";

          const head = document.createElement("div");
          head.className = "world-event-head";

          const mag = document.createElement("div");
          mag.className = "badge-strong";
          mag.innerHTML = `<strong>M${ev.mag.toFixed(1)}</strong> ¬∑ ${formatAgo(ev.time)}`;

          const timeExact = document.createElement("div");
          timeExact.className = "world-event-time";
          timeExact.textContent = formatDateTime(ev.time);

          head.appendChild(mag);
          head.appendChild(timeExact);

          const place = document.createElement("div");
          place.className = "world-event-place";
          place.textContent = ev.place || "–†–µ–≥–∏–æ–Ω –Ω–µ —É–∫–∞–∑–∞–Ω";

          const footer = document.createElement("div");
          footer.className = "world-event-footer";

          const tag = document.createElement("span");
          tag.className = "badge-pill-muted";
          tag.textContent = "–ú–∏—Ä–æ–≤–æ–µ —Å–æ–±—ã—Ç–∏–µ ¬∑ –¥–∞–ª–µ–∫–æ –æ—Ç –≤—ã–±—Ä–∞–Ω–Ω–æ–π —Ç–æ—á–∫–∏";

          const link = document.createElement("a");
          link.className = "event-link";
          link.href = ev.url || "#";
          link.target = "_blank";
          link.textContent = "–ò—Å—Ç–æ—á–Ω–∏–∫ USGS";

          footer.appendChild(tag);
          footer.appendChild(link);

          card.appendChild(head);
          card.appendChild(place);
          card.appendChild(footer);
          worldList.appendChild(card);
        });
      }

      function updateStatus(buckets) {
        const last = pickLastSignificant(buckets);
        if (!last) {
          statusCard.classList.remove(
            "status-card-critical",
            "status-card-warning",
            "status-card-noticeable"
          );
          statusChip.className = "status-chip status-chip-safe";
          statusChipText.textContent = "–°–ø–æ–∫–æ–π–Ω–æ";
          statusSummary.textContent =
            "–í –≤–∞—à–µ–º —Ä–µ–≥–∏–æ–Ω–µ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 7 –¥–Ω–µ–π –∑–Ω–∞—á–∏–º—ã—Ö —Å–æ–±—ã—Ç–∏–π –ø–æ–±–ª–∏–∑–æ—Å—Ç–∏ –Ω–µ –±—ã–ª–æ.";
          return;
        }

        const risk = riskLevel(last);
        statusCard.classList.remove(
          "status-card-critical",
          "status-card-warning",
          "status-card-noticeable"
        );
        statusChip.classList.remove(
          "status-chip-critical",
          "status-chip-warning",
          "status-chip-noticeable",
          "status-chip-safe"
        );

        if (risk === "critical") {
          statusCard.classList.add("status-card-critical");
          statusChip.classList.add("status-chip-critical");
          statusChipText.textContent = "–û—á–µ–Ω—å —Å–∏–ª—å–Ω–æ–µ —Ä—è–¥–æ–º";
          statusSummary.textContent =
            "–ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–æ –æ—á–µ–Ω—å —Å–∏–ª—å–Ω–æ–µ —Å–æ–±—ã—Ç–∏–µ –ø–æ–±–ª–∏–∑–æ—Å—Ç–∏. –û—Ç–æ–π–¥–∏—Ç–µ –æ—Ç –æ–∫–æ–Ω –∏ —Ç—è–∂—ë–ª—ã—Ö –ø—Ä–µ–¥–º–µ—Ç–æ–≤, —Å–ª–µ–¥—É–π—Ç–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º —Å–ª—É–∂–±.";
        } else if (risk === "warning") {
          statusCard.classList.add("status-card-warning");
          statusChip.classList.add("status-chip-warning");
          statusChipText.textContent = "–°–∏–ª—å–Ω—ã–µ —Ç–æ–ª—á–∫–∏";
          statusSummary.textContent =
            "–í–æ–∑–º–æ–∂–Ω—ã –æ—â—É—Ç–∏–º—ã–µ —Ç–æ–ª—á–∫–∏ –≤ –≤–∞—à–µ–º —Ä–µ–≥–∏–æ–Ω–µ. –õ—É—á—à–µ –æ—Ç–æ–π—Ç–∏ –æ—Ç —Å—Ç–µ–∫–ª–∞ –∏ —Ç—è–∂—ë–ª–æ–π –º–µ–±–µ–ª–∏, —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å–ø–æ–∫–æ–π—Å—Ç–≤–∏–µ.";
        } else if (risk === "noticeable") {
          statusCard.classList.add("status-card-noticeable");
          statusChip.classList.add("status-chip-noticeable");
          statusChipText.textContent = "–ú–æ–∂–µ—Ç –æ—â—É—â–∞—Ç—å—Å—è";
          statusSummary.textContent =
            "–ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–æ —Å–æ–±—ã—Ç–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –º–æ–∂–µ—Ç –æ—â—É—â–∞—Ç—å—Å—è, –Ω–æ –æ–±—ã—á–Ω–æ –Ω–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–µ—Ä—å—ë–∑–Ω–æ–π –æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –¥–ª—è —É—Å—Ç–æ–π—á–∏–≤—ã—Ö –∑–¥–∞–Ω–∏–π.";
        } else {
          statusChip.classList.add("status-chip-safe");
          statusSummary.textContent =
            "–°–µ–π—Å–º–∏—á–µ—Å–∫–∞—è –æ–±—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤ –≤–∞—à–µ–º —Ä–µ–≥–∏–æ–Ω–µ –±–µ–∑ —Å–µ—Ä—å—ë–∑–Ω—ã—Ö —É–≥—Ä–æ–∑ –ø–æ –ø–æ—Å–ª–µ–¥–Ω–∏–º –¥–∞–Ω–Ω—ã–º.";
          statusChipText.textContent = "–°–ø–æ–∫–æ–π–Ω–æ";
        }
      }

      /* -------- Location ---------- */

      async function detectLocationFromIP() {
        try {
          const res = await fetch("https://ipapi.co/json/");
          if (!res.ok) throw new Error("ipapi error " + res.status);
          const data = await res.json();
          if (
            data &&
            typeof data.latitude === "number" &&
            typeof data.longitude === "number"
          ) {
            userLocation.lat = data.latitude;
            userLocation.lon = data.longitude;
            const city = data.city || "";
            const country = data.country_name || "";
            userLocation.label = city || country
              ? (city ? city : "") + (city && country ? ", " : "") + (country ? country : "")
              : "–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–æ –ø–æ IP";
            setLocationInfo();
            recomputeDistances();
            return true;
          }
          throw new Error("no coords from IP");
        } catch (err) {
          console.warn("IP location failed:", err);
          return false;
        }
      }

      async function detectLocationAuto() {
        // 1) GPS / –≥–µ–æ–ª–æ–∫–∞—Ü–∏—è –±—Ä–∞—É–∑–µ—Ä–∞
        if ("geolocation" in navigator) {
          try {
            const position = await new Promise((resolve, reject) => {
              navigator.geolocation.getCurrentPosition(resolve, reject, {
                enableHighAccuracy: true,
                timeout: 8000,
                maximumAge: 60000,
              });
            });
            const { latitude, longitude } = position.coords;
            userLocation.lat = latitude;
            userLocation.lon = longitude;
            userLocation.label = "–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–æ –ø–æ GPS";
            setLocationInfo();
            recomputeDistances();
            return;
          } catch (err) {
            console.warn("Geolocation failed:", err);
          }
        }

        // 2) IP
        const ok = await detectLocationFromIP();
        if (!ok) {
          alert(
            "–ù–µ —É–¥–∞–ª–æ—Å—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ê–ª–º–∞—Ç—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, –≤—ã –º–æ–∂–µ—Ç–µ –≤—ã–±—Ä–∞—Ç—å –≥–æ—Ä–æ–¥ –≤—Ä—É—á–Ω—É—é."
          );
          userLocation = { ...DEFAULT_LOCATION };
          setLocationInfo();
          recomputeDistances();
        }
      }

      function recomputeDistances() {
        if (!lastEventsRaw || !lastEventsRaw.length) return;
        lastEventsRaw = enrichWithDistance(lastEventsRaw);
        const buckets = partitionLocal(lastEventsRaw);
        const world = pickWorldStrong(lastEventsRaw);
        renderLocalBuckets(buckets);
        updateStatus(buckets);
        renderWorld(world);
      }

      function handleCityInputChange(value) {
        const v = value.trim();
        if (!v) {
          // nothing yet, do not change location
          return;
        }
        // simple heuristic: we don't geocode, but we update label only
        userLocation.label = v;
        setLocationInfo();
        recomputeDistances();
      }

      /* -------- Modals ---------- */

      function setupModals() {
        const openers = document.querySelectorAll("[data-open-modal]");
        const closers = document.querySelectorAll("[data-close-modal]");

        openers.forEach((btn) => {
          btn.addEventListener("click", () => {
            const id = btn.getAttribute("data-open-modal");
            const backdrop = document.getElementById(id);
            if (backdrop) {
              backdrop.classList.add("active");
            }
          });
        });

        closers.forEach((btn) => {
          btn.addEventListener("click", () => {
            const backdrop = btn.closest(".modal-backdrop");
            if (backdrop) {
              backdrop.classList.remove("active");
            }
          });
        });

        document.querySelectorAll(".modal-backdrop").forEach((backdrop) => {
          backdrop.addEventListener("click", (e) => {
            if (e.target === backdrop) {
              backdrop.classList.remove("active");
            }
          });
        });
      }

      /* -------- Install / PWA ---------- */

      if ("serviceWorker" in navigator) {
        navigator.serviceWorker
          .register("sw.js")
          .catch((err) => console.warn("SW registration failed", err));
      }

      window.addEventListener("beforeinstallprompt", (event) => {
        event.preventDefault();
        deferredInstallPrompt = event;
        if (installBtn) {
          installBtn.style.display = "inline-flex";
        }
      });

      if (installBtn) {
        installBtn.addEventListener("click", async () => {
          if (!deferredInstallPrompt) return;
          deferredInstallPrompt.prompt();
          await deferredInstallPrompt.userChoice;
          deferredInstallPrompt = null;
          installBtn.style.display = "none";
        });
      }

      /* -------- Language (–ø—Ä–æ—Å—Ç–∞—è –∑–∞–≥–æ—Ç–æ–≤–∫–∞) ---------- */

      const langSelect = document.getElementById("langSelect");
      if (langSelect) {
        langSelect.addEventListener("change", () => {
          // –ü–æ–∫–∞ –Ω–µ –¥–µ–ª–∞–µ–º –ø–æ–ª–Ω—É—é –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏—é, —Ç–æ–ª—å–∫–æ —Å–æ—Ö—Ä–∞–Ω—è–µ–º –≤—ã–±–æ—Ä
          localStorage.setItem("seismoWakeLang", langSelect.value);
        });
        const saved = localStorage.getItem("seismoWakeLang");
        if (saved && Array.from(langSelect.options).some(o => o.value === saved)) {
          langSelect.value = saved;
        }
      }

      /* -------- Init ---------- */

      async function refreshData() {
        try {
          const events = await fetchEvents();
          lastEventsRaw = enrichWithDistance(events);
          lastFetchTime = Date.now();
          lastDataOk = true;
          setUpdatedTime(lastFetchTime);

          const buckets = partitionLocal(lastEventsRaw);
          const world = pickWorldStrong(lastEventsRaw);

          renderLocalBuckets(buckets);
          updateStatus(buckets);
          renderWorld(world);
        } catch (err) {
          console.error("Fetch error:", err);
          setUpdatedTime(Date.now());
          if (!lastDataOk) {
            // No previous data
            const errDiv = document.createElement("div");
            errDiv.className = "error-state";
            errDiv.textContent =
              "–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –æ –∑–µ–º–ª–µ—Ç—Ä—è—Å–µ–Ω–∏—è—Ö. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.";
            clearNode(lastHourList);
            lastHourList.appendChild(errDiv);
          }
        }
      }

      function setupLocationControls() {
        if (detectLocationBtn) {
          detectLocationBtn.addEventListener("click", detectLocationAuto);
        }

        if (locSuggestions) {
          locSuggestions.addEventListener("click", (e) => {
            const chip = e.target.closest(".loc-chip");
            if (!chip) return;
            const label = chip.getAttribute("data-city") || "–í—ã–±—Ä–∞–Ω–Ω—ã–π —Ä–µ–≥–∏–æ–Ω";
            const lat = parseFloat(chip.getAttribute("data-lat"));
            const lon = parseFloat(chip.getAttribute("data-lon"));
            if (isFinite(lat) && isFinite(lon)) {
              userLocation.lat = lat;
              userLocation.lon = lon;
            }
            userLocation.label = label;
            setLocationInfo();
            recomputeDistances();
          });
        }

        if (cityInput) {
          let typingTimeout = null;
          cityInput.addEventListener("input", () => {
            const value = cityInput.value;
            clearTimeout(typingTimeout);
            typingTimeout = setTimeout(() => {
              handleCityInputChange(value);
            }, 500);
          });
        }

        setLocationInfo();
      }

      setupModals();
      setupLocationControls();
      refreshData();
      setInterval(refreshData, 30000); // –∫–∞–∂–¥—ã–µ ~30 —Å–µ–∫
    })();
  </script>
</body>
  </html>
